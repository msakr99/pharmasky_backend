{% load i18n %} {% load math %} {% load utils %} {% load static %}
{% get_language_info for 'ar' as lang %}
<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Financial Report - {{ data.pharmacy.name }}</title>
    <style>
      @page {
        size: A5 portrait;
        margin: 0.5cm;
      
        @bottom-right {
          content: counter(page) ' / ' counter(pages);
          font-size: 11px;
          margin-bottom: 0.25cm;
        }
      
        @bottom-left {
          content: 'v1.0';
          font-size: 11px;
          margin-bottom: 0.25cm;
        }
      }
      
      body {
        font-size: 10px;
      }
      
      .table {
        border-collapse: collapse;
        width: 100%;
      }
      
      .table.header td {
        padding: 0.1rem 0.25rem;
        text-align: center;
        font-weight: bold;
      }
      
      .table.header td.label {
        width: 15%;
        border-right: 1px dotted #000;
      }
      
      .table-header {
        border: 1px solid #888;
        padding: 0.1rem 0.25rem;
      }
      
      .table-cell {
        border: 1px solid #888;
        padding: 0.1rem 0.25rem;
      }
    </style>
  </head>

  <body>
    <table class="table header" style="font-size: 8px;">
      <tbody>
        <tr>
          <td class="label">
            {% translate 'Customer' %}
          </td>
          <td>{{ data.pharmacy_name }}</td>
          <td rowspan="2">
            <div style="display: flex; align-items: center; justify-content: end;">
              <img src="{% static 'images/logo-pdf.png' %}" style="width: 150px" alt="logo" />
            </div>
          </td>
        </tr>
        <tr>
          <td class="label">
            {% translate 'Report Date' %}
          </td>
          <td>{{ data.date|date }}</td>
        </tr>
      </tbody>
    </table>
    <hr />
    <h4 style="text-align: center; text-decoration: underline;">{% translate 'Pharmacy Financial Account Report' %}</h4>

    <table style="width: 100%; margin-bottom: 1rem; margin-top: 1rem; border-collapse: collapse;">
      <thead>
        <tr>
          <th class="table-header">
            {% translate '#' %}
          </th>
          <th class="table-header">
            {% translate 'Transaction Date' %}
          </th>
          <th class="table-header" style="text-align: center;">
            {% translate 'Type' %}
          </th>
          <th class="table-header" style="text-align: center;">
            {% translate 'Credit' %}
          </th>
          <th class="table-header" style="text-align: center;">
            {% translate 'Debt' %}
          </th>
          <th class="table-header" style="text-align: center;">
            {% translate 'Payment' %}
          </th>
          <th class="table-header" style="text-align: center;">
            {% translate 'Transaction #' %}
          </th>
        </tr>
      </thead>
      <tbody>
        {% for item in data.transactions %}
          <tr>
            <td class="table-cell">{{ forloop.counter }}</td>
            <td class="table-cell">{{ item.transaction_at|date }}</td>
            <td class="table-cell" style="text-align: center;">{{ item.transaction_type_label }}</td>
            <td class="table-cell" style="text-align: center;">
              {% if item.transaction_type == 'i' or item.transaction_type == 'ib' %}
                {{ item.transaction_value }}
              {% else %}
                -
              {% endif %}
            </td>
            <td class="table-cell" style="text-align: center;">
              {% if item.transaction_type == 'r' %}
                {{ item.transaction_value }}
              {% else %}
                -
              {% endif %}
            </td>
            <td class="table-cell" style="text-align: center;">
              {% if item.transaction_type == 'p' %}
                {{ item.transaction_value }}
              {% else %}
                -
              {% endif %}
            </td>
            <td class="table-cell" style="text-align: center;">
              {% if item.transaction_type == 'i' %}
                In # -
              {% elif item.transaction_type == 'r' %}
                Ret # -
              {% elif item.transaction_type == 'p' %}
                Pay # -
              {% endif %}
              {{ item.object_id|default_if_none:'-' }}
            </td>
          </tr>
        {% endfor %}
        <tr style="border-top: 2px solid #000">
          <td class="table-cell" colspan="3">
            {% translate 'Total' %}
          </td>
          <td class="table-cell" style="text-align: center;">{{ data.aggregates.invoice }}</td>
          <td class="table-cell" style="text-align: center;">{{ data.aggregates.return }}</td>
          <td class="table-cell" style="text-align: center;">{{ data.aggregates.payment }}</td>
          <td class="table-cell"></td>
        </tr>
        <tr>
          <td class="table-cell" colspan="3">
            {% translate 'Balance' %}
          </td>
          <td class="table-cell" colspan="4">
            <p style="margin-top:0.25rem; margin-bottom:0.25rem;">{{ data.balance_sign }} {{ data.balance }} ({{ data.balance|num2words }})</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell" colspan="2">
            {% translate 'Credit limit' %}
          </td>
          <td class="table-cell" colspan="2">{{ data.credit_limit }}</td>
          <td class="table-cell" colspan="2">
            {% translate 'Remaining Credit limit' %}
          </td>
          <td class="table-cell">{{ data.remaining_credit_limit }}</td>
        </tr>
      </tbody>
    </table>
  </body>
</html>
