# ملخص سريع - التحصيلات
# Quick Collections Reference

---

## 📋 أهم APIs للتحصيلات

### 1️⃣ عرض كل التحصيلات

```http
GET http://129.212.140.152/finance/sale-payments/
```

---

### 2️⃣ تحصيلات اليوم

```http
GET http://129.212.140.152/finance/sale-payments/?at=2025-10-10
```

---

### 3️⃣ تحصيلات الشهر

```http
GET http://129.212.140.152/finance/sale-payments/?at__gte=2025-10-01&at__lte=2025-10-31
```

---

### 4️⃣ تحصيلات صيدلية معينة

```http
GET http://129.212.140.152/finance/sale-payments/?user=5
```

---

### 5️⃣ التحصيلات الكاش فقط

```http
GET http://129.212.140.152/finance/sale-payments/?method=cash
```

---

### 6️⃣ تسجيل تحصيل جديد

```http
POST http://129.212.140.152/finance/sale-payments/create/
{
  "user": 5,
  "method": "cash",
  "amount": 5000,
  "at": "2025-10-10",
  "remarks": "تحصيل نقدي"
}
```

---

### 7️⃣ عرض الصيدليات المديونة

```http
GET http://129.212.140.152/accounts/users/?role=pharmacy
```

ابحث عن: `balance < 0` (السالب = مديون ليك)

---

### 8️⃣ إجمالي الديون المستحقة

```http
GET http://129.212.140.152/finance/safe/
```

انظر إلى: `credit_total_amount`

---

## 🎯 طرق الدفع

| الكود | الاسم | يؤثر على الخزنة؟ |
|------|-------|-----------------|
| `cash` | كاش | ✅ نعم |
| `instapay` | إنستاباي | ❌ لا |
| `wallet` | محفظة | ❌ لا |

---

## 📊 أمثلة سريعة

### مثال 1: تحصيل كاش

```json
{
  "user": 5,
  "method": "cash",
  "amount": 5000,
  "at": "2025-10-10"
}
```

**التأثير:**
- ✅ رصيد الصيدلية += 5,000
- ✅ الخزنة += 5,000
- ✅ الديون ليك -= 5,000

---

### مثال 2: تحصيل إنستاباي

```json
{
  "user": 7,
  "method": "instapay",
  "amount": 10000,
  "at": "2025-10-10"
}
```

**التأثير:**
- ✅ رصيد الصيدلية += 10,000
- ❌ الخزنة لا تتأثر
- ✅ الديون ليك -= 10,000

---

## 🔍 الفلاتر الشائعة

```
# حسب التاريخ
?at=2025-10-10

# من تاريخ معين
?at__gte=2025-10-01

# حتى تاريخ معين
?at__lte=2025-10-31

# في فترة معينة
?at__gte=2025-10-01&at__lte=2025-10-31

# حسب الصيدلية
?user=5

# حسب طريقة الدفع
?method=cash

# دمج فلاتر
?at__gte=2025-10-01&method=cash&user=5
```

---

## 📱 استخدام سريع

### السيناريو: عايز أعرف تحصيلات النهاردة

```http
GET http://129.212.140.152/finance/sale-payments/?at=2025-10-10
```

---

### السيناريو: عايز أسجل تحصيل

```http
POST http://129.212.140.152/finance/sale-payments/create/
{
  "user": 5,
  "method": "cash",
  "amount": 5000,
  "at": "2025-10-10"
}
```

---

### السيناريو: عايز أعرف الصيدليات المديونة

```http
GET http://129.212.140.152/accounts/users/?role=pharmacy
```

الصيدليات اللي `balance < 0` هي المديونة

---

### السيناريو: عايز أعرف إجمالي الفلوس اللي ليا

```http
GET http://129.212.140.152/finance/safe/
```

شوف `credit_total_amount`

---

## ✅ تذكر!

1. **كاش بس** اللي يدخل الخزنة
2. **الرصيد السالب** = صيدلية مديونة ليك
3. **الرصيد الموجب** = أنت مديون للمورد
4. **الرصيد صفر** = مافيش ديون

---

## 📞 تواصل

**الدليل الشامل:** انظر `COLLECTIONS_GUIDE.md`

---

**آخر تحديث**: 2025-10-10  
**الحالة**: ✅ جاهز

