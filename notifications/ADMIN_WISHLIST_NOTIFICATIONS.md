# ๐จโ๐ผโจ ุฅุดุนุงุฑุงุช ุงูู Admin ู Wishlist

ุฏููู ุดุงูู ูุฅุดุนุงุฑุงุช ุงูู Admin ูุฅุดุนุงุฑุงุช ุชููุฑ ุงูููุชุฌุงุช ูู Wishlist.

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

1. [ุฅุดุนุงุฑุงุช ุงูู Admin](#ุฅุดุนุงุฑุงุช-ุงูู-admin)
2. [ุฅุดุนุงุฑุงุช Wishlist](#ุฅุดุนุงุฑุงุช-wishlist)
3. [ุฃูุซูุฉ ุนูููุฉ](#ุฃูุซูุฉ-ุนูููุฉ)
4. [ููุฎุต ูุงูู](#ููุฎุต-ูุงูู)

---

## ๐จโ๐ผ ุฅุดุนุงุฑุงุช ุงูู Admin

ุงูู Admin ูุงูู Manager ูุณุชูููุง ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ ุนู ุฌููุน ุงูุฃุญุฏุงุซ ุงููููุฉ ูู ุงููุธุงู.

### 1. ุชุณุฌูู ุตูุฏููุฉ ุฌุฏูุฏุฉ ๐ช

```python
from accounts.models import User, Pharmacy

# ุชุณุฌูู ุตูุฏููุฉ ุฌุฏูุฏุฉ
pharmacy = User.objects.create(
    username="+201234567890",
    name="ุตูุฏููุฉ ุงูููุฑ",
    role='PHARMACY',
    is_active=True
)

# โจ ุฅุดุนุงุฑ ุชููุงุฆู ูุฌููุน ุงูู Admins:
# "๐ช ุชุณุฌูู ุตูุฏููุฉ ุฌุฏูุฏุฉ"
# "ุชู ุชุณุฌูู ุตูุฏููุฉ ุฌุฏูุฏุฉ: ุตูุฏููุฉ ุงูููุฑ (+201234567890)"
```

**ูุนูููุงุช ุงูุฅุดุนุงุฑ:**
- ุงูุนููุงู: "๐ช ุชุณุฌูู ุตูุฏููุฉ ุฌุฏูุฏุฉ"
- ุงููุญุชูู: ุงุณู ุงูุตูุฏููุฉ ูุฑูู ุงููุงุชู
- Extra Data: 
  - `pharmacy_id`: ID ุงูุตูุฏููุฉ
  - `pharmacy_name`: ุงุณู ุงูุตูุฏููุฉ
  - `pharmacy_username`: ุฑูู ุงููุงุชู
  - `area`: ุงูููุทูุฉ

---

### 2. ูุงุชูุฑุฉ ุดุฑุงุก ุฌุฏูุฏุฉ ๐ฆ

```python
from invoices.models import PurchaseInvoice

# ุฅูุดุงุก ูุงุชูุฑุฉ ุดุฑุงุก
invoice = PurchaseInvoice.objects.create(
    user=store_user,
    items_count=20,
    total_quantity=100,
    total_price=15000.00,
    status='PLACED'
)

# โจ ุฅุดุนุงุฑ ุชููุงุฆู ูุฌููุน ุงูู Admins:
# "๐ฆ ูุงุชูุฑุฉ ุดุฑุงุก ุฌุฏูุฏุฉ"
# "ูุงุชูุฑุฉ ุดุฑุงุก ุฌุฏูุฏุฉ #123 ูู ูุฎุฒู ุงูุฃูู ุจูููุฉ 15000 ุฌููู"
```

**ูุนูููุงุช ุงูุฅุดุนุงุฑ:**
- Extra Data:
  - `invoice_id`: ุฑูู ุงููุงุชูุฑุฉ
  - `user_id`: ID ุงููุฎุฒู
  - `user_name`: ุงุณู ุงููุฎุฒู
  - `total_price`: ุฅุฌูุงูู ุงูุณุนุฑ
  - `items_count`: ุนุฏุฏ ุงูุฃุตูุงู

---

### 3. ูุงุชูุฑุฉ ุจูุน ุฌุฏูุฏุฉ (ุทูุจ ุตูุฏููุฉ) ๐

```python
from invoices.models import SaleInvoice

# ุตูุฏููุฉ ุชุนูู ุทูุจ
invoice = SaleInvoice.objects.create(
    user=pharmacy_user,
    items_count=15,
    total_quantity=50,
    total_price=7500.00,
    status='PLACED'
)

# โจ ุฅุดุนุงุฑ ุชููุงุฆู ูุฌููุน ุงูู Admins:
# "๐ ุทูุจ ุฌุฏูุฏ"
# "ุทูุจ ุฌุฏูุฏ #456 ูู ุตูุฏููุฉ ุงูููุฑ ุจูููุฉ 7500 ุฌููู"
```

---

### 4. ุนูููุฉ ุฏูุน ๐ฐ

#### ุฏูุนุฉ ุดุฑุงุก (ูู ุงููุฎุฒู):
```python
from finance.models import PurchasePayment

payment = PurchasePayment.objects.create(
    user=store_user,
    method='BANK',
    amount=10000.00,
    at=timezone.now()
)

# Admin ูุณุชูู ูุณุฎุฉ ูู ุงูุฅุดุนุงุฑ
```

#### ุฏูุนุฉ ุจูุน (ูู ุงูุตูุฏููุฉ):
```python
from finance.models import SalePayment

payment = SalePayment.objects.create(
    user=pharmacy_user,
    method='CASH',
    amount=5000.00,
    at=timezone.now()
)

# Admin ูุณุชูู ูุณุฎุฉ ูู ุงูุฅุดุนุงุฑ
```

---

### 5. ูุฑุชุฌุนุงุช ๐ฆโฉ๏ธ

```python
from invoices.models import SaleReturnInvoice

# ุตูุฏููุฉ ุชุฑุฌุน ููุชุฌุงุช
return_inv = SaleReturnInvoice.objects.create(
    user=pharmacy_user,
    items_count=3,
    total_quantity=10,
    total_price=1200.00,
    status='PLACED'
)

# Admin ูุณุชูู ูุณุฎุฉ ูู ุงูุฅุดุนุงุฑ
```

---

### 6. ุดููู ุฌุฏูุฏุฉ ๐ข

```python
from profiles.models import Complaint

# ุตูุฏููุฉ ุชูุฏู ุดููู
complaint = Complaint.objects.create(
    user=pharmacy_user,
    subject="ูุดููุฉ ูู ุงูุชูุตูู",
    body="ุงูุทูุจ ุชุฃุฎุฑ 3 ุฃูุงู ุจุฏูู ุณุจุจ ูุงุถุญ",
    mark_as_solved=False
)

# โจ ุฅุดุนุงุฑ ุชููุงุฆู ูุฌููุน ุงูู Admins:
# "๐ข ุดููู ุฌุฏูุฏุฉ"
# "ุดููู ุฌุฏูุฏุฉ ูู ุตูุฏููุฉ ุงูููุฑ: ูุดููุฉ ูู ุงูุชูุตูู"
```

**ูุนูููุงุช ุงูุฅุดุนุงุฑ:**
- Extra Data:
  - `complaint_id`: ุฑูู ุงูุดููู
  - `user_id`: ID ุงููุณุชุฎุฏู
  - `user_name`: ุงุณู ุงููุณุชุฎุฏู
  - `subject`: ููุถูุน ุงูุดููู
  - `body`: ูุญุชูู ุงูุดููู

---

### 7. ุญู ุงูุดููู โ

```python
# Admin ูุญู ุงูุดููู
complaint.mark_as_solved = True
complaint.save()

# โจ ุฅุดุนุงุฑ ุชููุงุฆู ูููุณุชุฎุฏู ุตุงุญุจ ุงูุดููู:
# "โ ุชู ุญู ุดููุงู"
# "ุชู ุญู ุดููุงู: ูุดููุฉ ูู ุงูุชูุตูู. ุดูุฑุงู ูุชูุงุตูู ูุนูุง."
```

---

## โจ ุฅุดุนุงุฑุงุช Wishlist

ุนูุฏ ุฅุถุงูุฉ ุตูุฏููุฉ ูููุชุฌ ูู ุงูู wishlistุ ุชุณุชูู ุฅุดุนุงุฑ ุชููุงุฆู ุนูุฏ ุชููุฑ ุนุฑุถ ููุฐุง ุงูููุชุฌ.

### ููู ูุนููุ

```python
from market.models import PharmacyProductWishList, Product

# 1. ุงูุตูุฏููุฉ ุชุถูู ููุชุฌ ููู wishlist
product = Product.objects.get(id=123)
PharmacyProductWishList.objects.create(
    pharmacy=pharmacy_user,
    product=product
)

# 2. ูุฎุฒู ูุถูู ุนุฑุถ ููููุชุฌ
from offers.models import Offer

offer = Offer.objects.create(
    product=product,
    user=store_user,
    available_amount=100,
    remaining_amount=100,
    purchase_discount_percentage=25.00,
    selling_discount_percentage=20.00,
    selling_price=80.00,
    purchase_price=75.00
)

# โจ ุฅุดุนุงุฑ ุชููุงุฆู ููุตูุฏููุฉ:
# "โจ ููุชุฌ ูุชููุฑ ูู ูุงุฆูุฉ ุงูุฑุบุจุงุช!"
# "ุงูููุชุฌ 'ุจุงุฑุงุณูุชุงููู 500 ูุฌู' ุฃุตุจุญ ูุชููุฑุงู ุงูุขู ุจุฎุตู 20% ูุณุนุฑ 80 ุฌููู"
```

### ูุนูููุงุช ุงูุฅุดุนุงุฑ:

```json
{
  "type": "wishlist_product_available",
  "product_id": 123,
  "product_name": "ุจุงุฑุงุณูุชุงููู 500 ูุฌู",
  "offer_id": 789,
  "seller_id": 45,
  "seller_name": "ูุฎุฒู ุงูุฃูู",
  "discount": "20.00",
  "price": "80.00",
  "available_amount": 100
}
```

---

## ๐ฏ ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1: ุณููุงุฑูู ูุงูู ููุตูุฏููุฉ

```python
from market.models import PharmacyProductWishList, Product
from offers.models import Offer

# ุตูุฏููุฉ ุชุฏูุฑ ุนูู ููุชุฌ
product = Product.objects.get(name__icontains="ุฃูููุณูุณูููู")

# ุงูููุชุฌ ูุด ูุชููุฑุ ุชุถููู ููู wishlist
wishlist_item = PharmacyProductWishList.objects.create(
    pharmacy=pharmacy_user,
    product=product
)

print(f"โ ุชู ุฅุถุงูุฉ {product.name} ููุงุฆูุฉ ุงูุฑุบุจุงุช")

# ุจุนุฏ ููููู... ูุฎุฒู ูุถูู ุนุฑุถ ููููุชุฌ
offer = Offer.objects.create(
    product=product,
    user=store_user,
    available_amount=200,
    remaining_amount=200,
    selling_discount_percentage=22.00,
    selling_price=85.00,
    purchase_discount_percentage=25.00,
    purchase_price=80.00
)

# โจ ุงูุตูุฏููุฉ ุชุณุชูู ุฅุดุนุงุฑ ููุฑู:
# "โจ ููุชุฌ ูุชููุฑ ูู ูุงุฆูุฉ ุงูุฑุบุจุงุช!"
# "ุงูููุชุฌ 'ุฃูููุณูุณูููู 250 ูุฌู' ุฃุตุจุญ ูุชููุฑุงู ุงูุขู ุจุฎุตู 22% ูุณุนุฑ 85 ุฌููู"
```

### ูุซุงู 2: Admin ูุชุงุจุน ุงููุดุงุทุงุช

```python
# ูู ููู ูุงุญุฏุ ุงูู Admin ูุณุชูู:

# 1. ุตุจุงุญุงู: ุชุณุฌูู 3 ุตูุฏููุงุช ุฌุฏูุฏุฉ
# "๐ช ุชุณุฌูู ุตูุฏููุฉ ุฌุฏูุฏุฉ" (x3)

# 2. ุธูุฑุงู: 15 ุทูุจ ุฌุฏูุฏ ูู ุตูุฏููุงุช
# "๐ ุทูุจ ุฌุฏูุฏ" (x15)

# 3. ุนุตุฑุงู: 5 ุฏูุนุงุช ูู ุตูุฏููุงุช
# "๐ฐ ุฏูุนุฉ ุฌุฏูุฏุฉ" (x5)

# 4. ูุณุงุกู: 2 ุดูุงูู
# "๐ข ุดููู ุฌุฏูุฏุฉ" (x2)

# 5. ูููุงู: ูุฑุชุฌุน ูุงุญุฏ
# "โฉ๏ธ ุทูุจ ุฅุฑุฌุงุน ุฌุฏูุฏ" (x1)

# Total: 26 ุฅุดุนุงุฑ ูู ููู ูุงุญุฏ
```

---

## ๐ ููุฎุต ูุงูู ูุฌููุน ุงูุฅุดุนุงุฑุงุช

### ููุตูุฏููุฉ ๐

| ุงูุญุฏุซ | ุงูุฅุดุนุงุฑ | ุงูุชููุงุฆู |
|------|---------|----------|
| ุทูุจ ุฌุฏูุฏ | ๐ ุทูุจ ุฌุฏูุฏ ุชู ุฅูุดุงุคู | โ |
| ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ | ๐ ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ | โ |
| ุฏูุนุฉ ุชู ุชุณุฌูููุง | โ ุชู ุชุณุฌูู ุฏูุนุชู | โ |
| ูุฑุชุฌุน ุชู ุฅูุดุงุคู | โฉ๏ธ ุทูุจ ุฅุฑุฌุงุน ุชู ุฅูุดุงุคู | โ |
| ููุงููุฉ ุนูู ุงููุฑุชุฌุน | โ ุชูุช ุงูููุงููุฉ | โ |
| ุฑูุถ ุงููุฑุชุฌุน | โ ุชู ุฑูุถ ุงูุฅุฑุฌุงุน | โ |
| ุงูุชูุงู ุงููุฑุชุฌุน | โ ุชู ุฅููุงู ุงูุฅุฑุฌุงุน | โ |
| ุญู ุงูุดููู | โ ุชู ุญู ุดููุงู | โ |
| **ููุชุฌ ูู Wishlist ูุชููุฑ** | **โจ ููุชุฌ ูุชููุฑ!** | **โ** |

### ูููุฎุฒู ๐ช

| ุงูุญุฏุซ | ุงูุฅุดุนุงุฑ | ุงูุชููุงุฆู |
|------|---------|----------|
| ูุงุชูุฑุฉ ุดุฑุงุก ุฌุฏูุฏุฉ | ๐ฆ ูุงุชูุฑุฉ ุดุฑุงุก ุฌุฏูุฏุฉ | โ |
| ุชุญุฏูุซ ุญุงูุฉ ูุงุชูุฑุฉ ุงูุดุฑุงุก | ๐ ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ | โ |
| ุฏูุนุฉ ุดุฑุงุก | ๐ฐ ุฏูุนุฉ ุดุฑุงุก ุฌุฏูุฏุฉ | โ |
| ูุฑุชุฌุน ุดุฑุงุก | โฉ๏ธ ูุฑุชุฌุน ุดุฑุงุก ุฌุฏูุฏ | โ |

### ููู Admin ๐จโ๐ผ

| ุงูุญุฏุซ | ุงูุฅุดุนุงุฑ | ุงูุชููุงุฆู |
|------|---------|----------|
| **ุชุณุฌูู ุตูุฏููุฉ ุฌุฏูุฏุฉ** | **๐ช ุชุณุฌูู ุตูุฏููุฉ ุฌุฏูุฏุฉ** | **โ** |
| **ูุงุชูุฑุฉ ุดุฑุงุก** | **๐ฆ ูุงุชูุฑุฉ ุดุฑุงุก ุฌุฏูุฏุฉ** | **โ** |
| **ูุงุชูุฑุฉ ุจูุน (ุทูุจ)** | **๐ ุทูุจ ุฌุฏูุฏ** | **โ** |
| **ุดููู ุฌุฏูุฏุฉ** | **๐ข ุดููู ุฌุฏูุฏุฉ** | **โ** |
| ุฏูุนุฉ ุดุฑุงุก | ๐ฐ ุฏูุนุฉ ุดุฑุงุก ุฌุฏูุฏุฉ | โ |
| ุฏูุนุฉ ุจูุน | โ ุชู ุชุณุฌูู ุฏูุนุฉ | โ |
| ูุฑุชุฌุน ุดุฑุงุก | โฉ๏ธ ูุฑุชุฌุน ุดุฑุงุก ุฌุฏูุฏ | โ |
| ูุฑุชุฌุน ุจูุน | โฉ๏ธ ุทูุจ ุฅุฑุฌุงุน ุฌุฏูุฏ | โ |

---

## ๐ง ุงูุชุฎุตูุต

### ุชุนุทูู ุฅุดุนุงุฑุงุช ูุนููุฉ

ููููู ุชุนุทูู ุฃู signal ุจุชุนุฏูู ุงูููู ุงูููุงุณุจ:

```python
# ูู offers/signals.py
# ุนูู ุฃู ุงุญุฐู ุงูู @receiver decorator

# @receiver(post_save, sender=Offer)  # ุนูู ูุฐุง ุงูุณุทุฑ
def notify_wishlist_pharmacies_on_offer_created(sender, instance, created, **kwargs):
    # ...
```

### ุฅุถุงูุฉ ูุณุชูุจููู ุฅุถุงูููู

```python
# ูู ุฃู signals.py
from notifications.models import Notification

def send_to_specific_users(event_data):
    """ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ููุณุชุฎุฏููู ูุญุฏุฏูู."""
    users = User.objects.filter(role='SALES')  # ูุซุงู
    
    notifications = []
    for user in users:
        notifications.append(
            Notification(
                user=user,
                title="ุฅุดุนุงุฑ ูุฎุตุต",
                message="ูุญุชูู ุงูุฅุดุนุงุฑ",
                extra=event_data
            )
        )
    
    Notification.objects.bulk_create(notifications)
```

---

## ๐ฑ ุงุณุชุนูุงู ุงูุฅุดุนุงุฑุงุช ูู API

### ุฌูุจ ุฅุดุนุงุฑุงุช Admin:

```bash
# ุฅุดุนุงุฑุงุช Admin ููุท
curl http://localhost:8000/notifications/notifications/?extra__type__contains=admin \
     -H "Authorization: Token ADMIN_TOKEN"
```

### ุฌูุจ ุฅุดุนุงุฑุงุช Wishlist:

```bash
# ุฅุดุนุงุฑุงุช Wishlist ููุท
curl http://localhost:8000/notifications/notifications/?extra__type=wishlist_product_available \
     -H "Authorization: Token PHARMACY_TOKEN"
```

---

## โ ุงูุฎูุงุตุฉ

### ุงูุชููุงุฆู (Automatic)
โ **ุชุณุฌูู ุตูุฏููุฉ** โ ุฅุดุนุงุฑ ููู Admin  
โ **ููุงุชูุฑ** โ ุฅุดุนุงุฑ ููู Admin ูุงููุณุชุฎุฏู  
โ **ุฏูุน** โ ุฅุดุนุงุฑ ููู Admin ูุงููุณุชุฎุฏู  
โ **ูุฑุชุฌุนุงุช** โ ุฅุดุนุงุฑ ููู Admin ูุงููุณุชุฎุฏู  
โ **ุดูุงูู** โ ุฅุดุนุงุฑ ููู Admin  
โ **ุญู ุดููู** โ ุฅุดุนุงุฑ ูููุณุชุฎุฏู  
โ **ููุชุฌ Wishlist ูุชููุฑ** โ ุฅุดุนุงุฑ ููุตูุฏููุงุช ุงูููุชูุฉ  

**ูู ุดูุก ุชููุงุฆู! ุงููุธุงู ูุดุชุบู ูู ุงูุฎูููุฉ ๐**

---

## ๐ ูููุงุช ุงูุชูุซูู ุงูุฃุฎุฑู

- `notifications/README.md` - ุงูุชูุซูู ุงูุฑุฆูุณู
- `notifications/USAGE_EXAMPLES.md` - ุฃูุซูุฉ ุงูููุงุชูุฑ
- `notifications/PAYMENT_RETURN_NOTIFICATIONS.md` - ุงูุฏูุน ูุงููุฑุชุฌุนุงุช
- `notifications/ADMIN_WISHLIST_NOTIFICATIONS.md` - ูุฐุง ุงูููู โญ

---

**๐ ูุธุงู ุงูุฅุดุนุงุฑุงุช ูุชูุงูู ุจุงููุงูู!**

