#!/bin/bash
# ุณูุฑูุจุช ุชุดุฎูุต ุงูุณูุฑูุฑ ููุญุต ุงูุฅุดุนุงุฑุงุช

echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "๐ ูุญุต ุญุงูุฉ ุงูุณูุฑูุฑ - PharmaSky"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

# ุงูุฃููุงู
GREEN='\033[0;32m'
RED='\033[0;31m'
YELLOW='\033[1;33m'
NC='\033[0m'

# 1. ูุญุต Docker containers
echo -e "${YELLOW}๐ฆ 1. ูุญุต Docker Containers:${NC}"
if command -v docker &> /dev/null; then
    docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"
    echo ""
else
    echo "Docker ุบูุฑ ูุชููุฑ"
fi

# 2. ูุญุต ุงูู ports
echo -e "${YELLOW}๐ 2. ูุญุต Ports:${NC}"
netstat -tulpn | grep -E ':(80|8000|5432|6379)' || echo "ูู ูุชู ุงูุนุซูุฑ ุนูู ports ููุชูุญุฉ"
echo ""

# 3. ูุญุต Nginx
echo -e "${YELLOW}๐ 3. ูุญุต Nginx:${NC}"
if systemctl is-active --quiet nginx; then
    echo -e "${GREEN}โ Nginx ูุนูู${NC}"
else
    echo -e "${RED}โ Nginx ูุง ูุนูู${NC}"
fi
echo ""

# 4. ุงุฎุชุจุงุฑ ุงูุงุชุตุงู
echo -e "${YELLOW}๐ 4. ุงุฎุชุจุงุฑ ุงูุงุชุตุงู:${NC}"
echo "ูุญุงููุฉ ุงูุงุชุตุงู ุจู localhost..."
curl -I http://localhost 2>&1 | head -n 5
echo ""

echo "ูุญุงููุฉ ุงูุงุชุตุงู ุจู 167.71.40.9..."
curl -I http://167.71.40.9 2>&1 | head -n 5
echo ""

# 5. ูุญุต ุงููุณุงุฑ
echo -e "${YELLOW}๐ 5. ูุญุต ุงููุณุงุฑ:${NC}"
pwd
ls -la | head -n 10
echo ""

# 6. ูุญุต manage.py
echo -e "${YELLOW}๐ 6. ูุญุต Django:${NC}"
if [ -f "manage.py" ]; then
    echo -e "${GREEN}โ manage.py ููุฌูุฏ${NC}"
    
    # ุงูุชุญูู ูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ
    if [ -d "venv" ]; then
        echo -e "${GREEN}โ venv ููุฌูุฏ${NC}"
    elif [ -d "env" ]; then
        echo -e "${GREEN}โ env ููุฌูุฏ${NC}"
    else
        echo -e "${YELLOW}โ๏ธ  ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ ุบูุฑ ููุฌูุฏุฉ ูู ุงููุณุงุฑ ุงูุญุงูู${NC}"
    fi
else
    echo -e "${RED}โ manage.py ุบูุฑ ููุฌูุฏ ูู ุงููุณุงุฑ ุงูุญุงูู${NC}"
fi
echo ""

# 7. ูุญุต logs (Docker)
echo -e "${YELLOW}๐ 7. ุขุฎุฑ 10 ุฃุณุทุฑ ูู logs (ุฅู ูุฌุฏุช):${NC}"
if docker ps --format '{{.Names}}' | grep -q 'web\|django\|pharmasky'; then
    CONTAINER_NAME=$(docker ps --format '{{.Names}}' | grep -E 'web|django|pharmasky' | head -n 1)
    echo "Container: $CONTAINER_NAME"
    docker logs --tail 10 "$CONTAINER_NAME" 2>&1 || echo "ูุง ูููู ูุฑุงุกุฉ logs"
fi
echo ""

echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo -e "${GREEN}โ ุงูุชูู ุงููุญุต${NC}"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"

