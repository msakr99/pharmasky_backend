# ๐ฏ ุฏููู ุงูุจุญุซ ุงููุชูุฏู ูู Max Offers

## ๐ ุงูู Endpoint

```
GET /offers/max-offers/
```

---

## ๐ ุงูุจุฏุก ุงูุณุฑูุน

### ูุซุงู ุจุณูุท - Hybrid (ุงูุงูุชุฑุงุถู):

```bash
curl "http://your-server/offers/max-offers/?q=ุจุงุฑุงุณูุชุงููู"
```

### ูุน ุชุญุฏูุฏ ุงููุถุน:

```bash
# Hybrid Mode
curl "http://your-server/offers/max-offers/?q=ุจุงุฑุงุณูุชุงููู&search_mode=hybrid"

# FTS Mode (ุฃุณุฑุน)
curl "http://your-server/offers/max-offers/?q=ุฃุณุจุฑูู&search_mode=fts"

# Trigram Mode (ููุฃุฎุทุงุก)
curl "http://your-server/offers/max-offers/?q=parasetmol&search_mode=trigram"
```

---

## ๐จ ุงูุฃูุถุงุน ุงูุซูุงุซุฉ

### 1. Hybrid Mode - ุงููุถุน ุงูุฐูู (ููุตู ุจู)

```bash
?q=ุจุงุฑุงุณูุชุงููู&search_mode=hybrid
```

**ูุชู ุชุณุชุฎุฏูู:**
- โ ุงูุงุณุชุฎุฏุงู ุงูุนุงู ุงููููู
- โ ุนุงูุฒ ุฃูุถู ูุชุงุฆุฌ
- โ ุจุชุจุญุซ ุจุงูุนุฑุจู ุฃู ุงูุฅูุฌููุฒู
- โ ูููู ูู ุฃุฎุทุงุก ุจุณูุทุฉ

**ุงููููุฒุงุช:**
- ุฏูุฉ 85-90%
- ูุฌูุน FTS + Trigram
- ุชุญูู ุฃุฎุทุงุก ุจุณูุทุฉ
- ุชุฑุชูุจ ุฐูู

**ุงูุฃุฏุงุก:**
- ุฃูู ุจุญุซ: 30-150ms
- ูู ุงููุงุด: 5-10ms

---

### 2. FTS Mode - ุงููุถุน ุงูุณุฑูุน

```bash
?q=ุฃุณุจุฑูู&search_mode=fts
```

**ูุชู ุชุณุชุฎุฏูู:**
- โ ุนุงูุฒ ุณุฑุนุฉ ูุตูู
- โ ูุชุฃูุฏ ูู ุงููุชุงุจุฉ ุงูุตุญูุญุฉ
- โ ุจุชุจุญุซ ุจูููุงุช ุฏูููุฉ

**ุงููููุฒุงุช:**
- ุฃุณุฑุน ูุถุน (10-50ms)
- ุฏูุฉ ุนุงููุฉ ูููููุงุช ุงูุตุญูุญุฉ
- ุฏุนู ููุชุงุฒ ููุนุฑุจูุฉ

**ููุงุญุธุฉ:**
- ูุง ูุชุนุงูู ูุน ุงูุฃุฎุทุงุก ุงูุฅููุงุฆูุฉ

---

### 3. Trigram Mode - ูุถุน ุงูุฃุฎุทุงุก

```bash
?q=parasetmol&search_mode=trigram&min_similarity=0.2
```

**ูุชู ุชุณุชุฎุฏูู:**
- โ ูุด ูุชุฃูุฏ ูู ุงููุชุงุจุฉ
- โ ูููู ูู ุฎุทุฃ ุฅููุงุฆู
- โ ุนุงูุฒ ูุชุงุฆุฌ ูุดุงุจูุฉ

**ุงููููุฒุงุช:**
- ููุงูู ุงููููุงุช ุงููุดุงุจูุฉ
- ุชุญูู ุฃุฎุทุงุก 80-90%
- Fuzzy matching ุฐูู

**Parameters:**
- `min_similarity`: 0.0 - 1.0 (ุงูุงูุชุฑุงุถู: 0.2)
  - `0.15` = ูุชุงุฆุฌ ูุชูุฑ (ุฃูู ุฏูุฉ)
  - `0.2` = ูุชูุงุฒู (ููุตู ุจู)
  - `0.5` = ูุชุงุฆุฌ ุฏูููุฉ (ุฃูู ุนุฏุฏ)

---

## ๐ ุงูุญููู ุงููุจุญูุซุฉ

ูุจุญุซ ูู 4 ุญููู ุจุฃูุฒุงู ูุฎุชููุฉ:

| ุงูุญูู | ูุฒู FTS | ูุฒู Trigram | ูุซุงู |
|-------|---------|-------------|------|
| ๐ฅ ุงุณู ุงูููุชุฌ | A (ุฃุนูู) | 100% | "ุจุงุฑุงุณูุชุงููู 500 ูุฌู" |
| ๐ฅ ุงููุงุฏุฉ ุงููุนุงูุฉ | B | 80% | "ุจุงุฑุงุณูุชุงููู" |
| ๐ฅ ุงุณู ุงูุดุฑูุฉ | C | 60% | "ูููุงุฑุชุณ" |
| ๐ ุงูุงุณู ุงูุฅูุฌููุฒู | D (ุฃูู) | 40% | "Paracetamol" |

---

## ๐ฐ ูุนูููุงุช ุงูุนุฑุถ ุงููุฑุฌุนุฉ

```json
{
  "count": 15,
  "results": [
    {
      "id": 123,
      "product": {
        "name": "ุจุงุฑุงุณูุชุงููู 500 ูุฌู",
        "e_name": "Paracetamol 500mg",
        "company": "ูููุงุฑุชุณ",
        "effective_material": "ุจุงุฑุงุณูุชุงููู",
        "public_price": "15.50"
      },
      "selling_price": 12.50,
      "selling_discount_percentage": 15.5,
      "actual_discount_precentage": 15.5,  // ุญุณุจ ููุน ุงููุณุชุฎุฏู
      "actual_offer_price": 10.56,         // ุงูุณุนุฑ ุงููุนูู
      "remaining_amount": 500,
      "min_purchase": 10,
      "rank": 0.95,      // FTS score
      "sim": 1.0,        // Trigram similarity
      "score": 0.92,     // Combined score (hybrid)
      "starts": 1        // Prefix match boost
    }
  ]
}
```

---

## ๐ง Parameters ุงููุงููุฉ

### Parameters ุงูุจุญุซ ุงูุฃุณุงุณูุฉ:

| Parameter | ุงูููุน | ุงูุงูุชุฑุงุถู | ุงููุตู |
|-----------|-------|-----------|-------|
| `q` | string | - | ูุต ุงูุจุญุซ (ุฅุฌุจุงุฑู) |
| `search_mode` | string | `hybrid` | ุงููุถุน: `fts`, `trigram`, `hybrid` |
| `min_similarity` | float | `0.2` | ุงูุญุฏ ุงูุฃุฏูู ููุชุดุงุจู (0.0-1.0) |

### Parameters ุฅุถุงููุฉ:

| Parameter | ุงููุตู | ูุซุงู |
|-----------|-------|------|
| `page` | ุฑูู ุงูุตูุญุฉ | `?q=test&page=2` |
| `page_size` | ุญุฌู ุงูุตูุญุฉ | `?q=test&page_size=50` |
| `ordering` | ุงูุชุฑุชูุจ | `?ordering=-selling_discount_percentage` |

**Ordering ุงููุชุงุญ:**
- `product__name` - ุญุณุจ ุงุณู ุงูููุชุฌ
- `product__public_price` - ุญุณุจ ุงูุณุนุฑ
- `selling_discount_percentage` - ุญุณุจ ูุณุจุฉ ุงูุฎุตู
- `selling_price` - ุญุณุจ ุณุนุฑ ุงูุจูุน
- `min_purchase` - ุญุณุจ ุงูุญุฏ ุงูุฃุฏูู ููุดุฑุงุก

---

## ๐ ุฃูุซูุฉ ูุชูุฏูุฉ

### 1. ุจุญุซ ุนู ุฏูุงุก ูุนูู

```bash
# ุจุงูุนุฑุจู
GET /offers/max-offers/?q=ุจุงุฑุงุณูุชุงููู&search_mode=hybrid

# ุจุงูุฅูุฌููุฒู
GET /offers/max-offers/?q=paracetamol&search_mode=hybrid
```

### 2. ุจุญุซ ุนู ุดุฑูุฉ

```bash
GET /offers/max-offers/?q=ูููุงุฑุชุณ&search_mode=fts
```

### 3. ุจุญุซ ูุน ุชุฑุชูุจ ุญุณุจ ุงูุฎุตู

```bash
GET /offers/max-offers/?q=ุฃุณุจุฑูู&ordering=-selling_discount_percentage
```

### 4. ุจุญุซ ูุน Pagination

```bash
# ุฃูู 50 ุนุฑุถ
GET /offers/max-offers/?q=ูุณูู&page_size=50

# ุงูุตูุญุฉ ุงูุซุงููุฉ
GET /offers/max-offers/?q=ูุณูู&page=2&page_size=50
```

### 5. ุจุญุซ ูุน ุฎุทุฃ ุฅููุงุฆู

```bash
# ูุจุญุซ ุนู: Paracetamol
GET /offers/max-offers/?q=parasetmol&search_mode=trigram&min_similarity=0.2
```

### 6. ุจุญุซ ุฏููู ุฌุฏุงู

```bash
GET /offers/max-offers/?q=aspirin&search_mode=trigram&min_similarity=0.7
```

---

## โก Redis Caching

ุงูุจุญุซ ูุณุชุฎุฏู Redis ุชููุงุฆูุงู:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   ๐ ุฃุฏุงุก ุงููุงุด                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                     โ
โ  ๐ ุฃูู ุจุญุซ:      30-150ms         โ
โ  โก ุจุญุซ ููุฑุฑ:     5-10ms           โ
โ  โฑ๏ธ ูุฏุฉ ุงููุงุด:    5 ุฏูุงุฆู          โ
โ  ๐พ ุนุฏุฏ ุงููุชุงุฆุฌ:   ุฃูู 100         โ
โ                                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ููุงุฆุฏ ุงููุงุด:**
- โ 10-50 ูุฑุฉ ุฃุณุฑุน ููุจุญุซ ุงูููุฑุฑ
- โ ุชูููู ุงูุญูู ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุงุณุชุฌุงุจุฉ ููุฑูุฉ ูููุณุชุฎุฏู

---

## ๐ฏ ุญุงูุงุช ุงุณุชุฎุฏุงู ุดุงุฆุนุฉ

### ุญุงูุฉ 1: ุตูุฏููุฉ ุชุจุญุซ ุนู ุฏูุงุก

```bash
# ุงูุจุญุซ
GET /offers/max-offers/?q=ุจุงุฑุงุณูุชุงููู&search_mode=hybrid

# ุงููุชูุฌุฉ: 
# - ูู ุนุฑูุถ ุงูุจุงุฑุงุณูุชุงููู
# - ูุฑุชุจุฉ ุญุณุจ ุงูุตูุฉ ูุงูุณุนุฑ
# - actual_offer_price ูุญุณูุจ ุญุณุจ ูุชุฑุฉ ุงูุณุฏุงุฏ
```

### ุญุงูุฉ 2: ููุธู ูุจูุนุงุช ูุจุญุซ ุจุณุฑุนุฉ

```bash
# ุจุญุซ ุณุฑูุน FTS
GET /offers/max-offers/?q=ุฃุณุจุฑูู&search_mode=fts

# ุงููุชูุฌุฉ ูู 10-20ms
```

### ุญุงูุฉ 3: ูุณุชุฎุฏู ุบูุฑ ูุชุฃูุฏ ูู ุงููุชุงุจุฉ

```bash
# ุจุญุซ Trigram ูุน ุชุญูู ุฃุฎุทุงุก
GET /offers/max-offers/?q=ibuproffen&search_mode=trigram&min_similarity=0.2

# ููุงูู: Ibuprofen (ุฑุบู ุงูุฎุทุฃ ุงููุฒุฏูุฌ)
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุนูู ุงูุณูุฑูุฑ ูุจุงุดุฑุฉ:

```bash
# ุงุฎุชุจุงุฑ ุจุณูุท
curl "http://localhost:8000/offers/max-offers/?q=test"

# ุงุฎุชุจุงุฑ ูุน Token
curl -H "Authorization: Token YOUR_TOKEN" \
  "http://localhost:8000/offers/max-offers/?q=ุจุงุฑุงุณูุชุงููู"
```

### ุจุงุณุชุฎุฏุงู ุงูุณูุฑูุจุช ุงูุฌุงูุฒ:

```bash
# Python script
python test_max_offers_search.py

# Bash script
bash test_max_offers_search.sh
```

---

## ๐ Authentication

ุงูุจุญุซ ูุญุชุงุฌ Authentication:

```bash
# ูุน Token
curl -H "Authorization: Token YOUR_TOKEN" \
  "http://localhost:8000/offers/max-offers/?q=test"

# ูู JavaScript/Axios
axios.get('/offers/max-offers/', {
  params: { q: 'ุจุงุฑุงุณูุชุงููู', search_mode: 'hybrid' },
  headers: { 'Authorization': 'Token YOUR_TOKEN' }
})
```

**ุงูุตูุงุญูุงุช ุงููุทููุจุฉ:**
- PHARMACY
- SALES
- DATA_ENTRY
- MANAGER

---

## ๐ก ูุตุงุฆุญ ููุฃุฏุงุก ุงูุฃูุถู

### 1. ุงุณุชุฎุฏู ุงููุถุน ุงูููุงุณุจ

```
โ ุงุณุชุฎุฏุงู ุนุงู โ hybrid
โ ุณุฑุนุฉ ูุตูู โ fts
โ ุฃุฎุทุงุก ุฅููุงุฆูุฉ โ trigram
```

### 2. ุถุจุท min_similarity

```
๐ ูุชุงุฆุฌ ูุซูุฑุฉ โ 0.15
๐ ูุชูุงุฒู โ 0.2 (ุงูุงูุชุฑุงุถู)
๐ ุฏูุฉ ุนุงููุฉ โ 0.5+
```

### 3. Pagination ูููุชุงุฆุฌ ุงููุซูุฑุฉ

```bash
# ุจุฏู ูุง ุชุฌูุจ 1000 ูุชูุฌุฉ
GET /offers/max-offers/?q=test&page_size=50
```

### 4. ุงุณุชูุฏ ูู ุงููุงุด

```
๐ ุงูุจุญูุซ ุงููุชูุฑุฑุฉ ุชููู ุฃุณุฑุน ุจูุซูุฑ
โฑ๏ธ ุงููุงุด ูุณุชูุฑ 5 ุฏูุงุฆู
```

---

## ๐ ุงูุฎูุงุตุฉ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   โ Max Offers Hybrid Search         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ                                       โ
โ  ๐ฏ 3 ุฃูุถุงุน ุฐููุฉ                     โ
โ  โก ูุงุด Redis ุณุฑูุน                    โ
โ  ๐ 4 ุญููู ุจุญุซ ุจุฃูุฒุงู                 โ
โ  ๐ธ๐ฆ ุฏุนู ูุงูู ููุนุฑุจูุฉ                 โ
โ  ๐ค ุฏุนู ุงูุฅูุฌููุฒูุฉ                    โ
โ  โ๏ธ ุชุญูู ุงูุฃุฎุทุงุก                      โ
โ  ๐ฐ ุญุณุงุจุงุช ููุฑูุฉ ููุฃุณุนุงุฑ              โ
โ  ๐ ูุชุงุฆุฌ ูุฑุชุจุฉ ุฐููุงู                 โ
โ                                       โ
โ  ๐ ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุงูููุฑู!           โ
โ                                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

**ูุญุชุงุฌ ูุณุงุนุฏุฉ ุฅุถุงููุฉุ** ุงุชุตู ุจูุฑูู ุงูุชุทููุฑ! ๐ค

