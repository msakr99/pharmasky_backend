# ๐ ุฏููู ูุดุฑ ุฅุตูุงุญุงุช ุงูุตูุงุญูุงุช ุนูู ุงูุฏุฑูุจููุช

## ๐ ุงููููุงุช ุงููุญุฏุซุฉ

### ูููุงุช ุงูููุฏ:
- `core/permissions.py` - ูุธุงู ุตูุงุญูุงุช ูุญุฏุซ
- `accounts/permissions.py` - ุฅุถุงูุฉ AdminRoleAuthentication  
- `market/views.py` - ุชุญุฏูุซ ุตูุงุญูุงุช ุงูููุชุฌุงุช
- `API_ENDPOINTS_PERMISSIONS.md` - ูุซุงุฆู ูุญุฏุซุฉ

### ูููุงุช ุงููุซุงุฆู:
- `PERMISSION_FIXES.md` - ุชุญููู ุงููุดุงูู ูุงูุญููู
- `COMPREHENSIVE_PERMISSION_SOLUTION.md` - ุงูุญู ุงูุดุงูู
- `DROPLET_DEPLOYMENT_GUIDE.md` - ูุฐุง ุงูููู

## ๐ง ุฎุทูุงุช ุงููุดุฑ ุนูู ุงูุฏุฑูุจููุช

### ุงูุฎุทูุฉ 1: ุฑูุน ุงููููุงุช ุงููุญุฏุซุฉ
```bash
# ุงูุงุชุตุงู ุจุงูุฏุฑูุจููุช
ssh root@129.212.140.152

# ุงูุงูุชูุงู ููุฌูุฏ ุงููุดุฑูุน
cd /path/to/pharmasky-project

# ุณุญุจ ุงูุชุญุฏูุซุงุช ูู Git
git pull origin main

# ุฃู ุฑูุน ุงููููุงุช ูุฏููุงู ุฅุฐุง ูู ุชูู ูู Git ุจุนุฏ
```

### ุงูุฎุทูุฉ 2: ุชุทุจูู ุงูุชุบููุฑุงุช
```bash
# ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ
source venv/bin/activate

# ุชุทุจูู migrations ุฅุฐุง ูุงูุช ููุงู ุชุบููุฑุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
python manage.py makemigrations
python manage.py migrate

# ุฌูุน ุงููููุงุช ุงูุซุงุจุชุฉ
python manage.py collectstatic --noinput
```

### ุงูุฎุทูุฉ 3: ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุฏูุงุช
```bash
# ุฅุนุงุฏุฉ ุชุดุบูู Gunicorn/uWSGI
sudo systemctl restart pharmasky-api
# ุฃู
sudo supervisorctl restart pharmasky-api

# ุฅุนุงุฏุฉ ุชุดุบูู Nginx
sudo systemctl restart nginx

# ุงูุชุญูู ูู ุญุงูุฉ ุงูุฎุฏูุงุช
sudo systemctl status pharmasky-api
sudo systemctl status nginx
```

### ุงูุฎุทูุฉ 4: ุฅุตูุงุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุงุฎุชูุงุฑู)
```sql
-- ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
sudo -u postgres psql pharmasky_db

-- ุชุญุฏูุซ is_superuser ูููุฏุฑุงุก
UPDATE accounts_user 
SET is_superuser = TRUE 
WHERE role = 'ADMIN';

-- ุงูุชุญูู ูู ุงูุชุญุฏูุซ
SELECT username, role, is_superuser 
FROM accounts_user 
WHERE role = 'ADMIN';

-- ุงูุฎุฑูุฌ
\q
```

## ๐งช ุงุฎุชุจุงุฑ ุงูุชุญุฏูุซุงุช

### ุงุฎุชุจุงุฑ 1: ุชุณุฌูู ุงูุฏุฎูู
```bash
curl -X POST "http://129.212.140.152/accounts/login/" \
  -H "Content-Type: application/json" \
  -d '{"username":"+201090572414","password":"Sakr4601"}'
```

### ุงุฎุชุจุงุฑ 2: ุงููุตูู ููููุชุฌุงุช (ูุฌุจ ุฃู ูุนูู ุงูุขู)
```bash
curl -X GET "http://129.212.140.152/market/products/" \
  -H "Authorization: Token YOUR_TOKEN"
```

### ุงุฎุชุจุงุฑ 3: endpoints ุฃุฎุฑู
```bash
# ุงุฎุชุจุงุฑ ุงูุดุฑูุงุช (PHARMACY ููุท)
curl -X GET "http://129.212.140.152/market/companies/list" \
  -H "Authorization: Token YOUR_TOKEN"

# ุงุฎุชุจุงุฑ ุงููุณุชุฎุฏููู (Staff ููุท)  
curl -X GET "http://129.212.140.152/accounts/users/" \
  -H "Authorization: Token YOUR_TOKEN"
```

## ๐ ุงููุชุงุฆุฌ ุงููุชููุนุฉ

### ูุจู ุงูุฅุตูุงุญ:
- โ ADMIN ูุง ููููู ุงููุตูู ููููุชุฌุงุช
- โ ุฑุณุงูุฉ ุฎุทุฃ: "You do not have permission"

### ุจุนุฏ ุงูุฅุตูุงุญ:
- โ ADMIN ููููู ุงููุตูู ูุฌููุน endpoints
- โ ูุธุงู ุตูุงุญูุงุช ููุญุฏ ููุงุถุญ
- โ ุฃุฏุงุก ุฃูุถู ูููุฏ ุฃูุธู

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฅุฐุง ูู ุชุนูู ุงูุฅุตูุงุญุงุช:

#### 1. ุงูุชุญูู ูู ุงูููุฌุฒ
```bash
# ููุฌุฒ ุงูุชุทุจูู
sudo journalctl -u pharmasky-api -f

# ููุฌุฒ Nginx
sudo tail -f /var/log/nginx/error.log
```

#### 2. ุงูุชุญูู ูู ุงูุชูููู
```bash
# ุงูุชุญูู ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ
cat /path/to/.env

# ุงูุชุญูู ูู ุฅุนุฏุงุฏุงุช Django
python manage.py shell
>>> from django.conf import settings
>>> print(settings.DEBUG)
```

#### 3. ุฅุนุงุฏุฉ ุชุดุบูู ูุงููุฉ
```bash
sudo systemctl restart pharmasky-api nginx postgresql
```

## ๐ ููุงุญุธุงุช ูููุฉ

### 1. ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ
- ุชุฃูุฏ ูู ุนูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุจู ุงูุชุญุฏูุซ
- ุงุญุชูุธ ุจูุณุฎุฉ ูู ุงูููุฏ ุงููุฏูู

### 2. ุงููุฑุงูุจุฉ
- ุฑุงูุจ ุงูููุฌุฒ ููุฏุฉ ุณุงุนุฉ ุจุนุฏ ุงููุดุฑ
- ุชุญูู ูู ุฃุฏุงุก API endpoints ุงููุฎุชููุฉ

### 3. ุงูุฑุฌูุน ููุฎูู
- ูู ุญุงูุฉ ูุฌูุฏ ูุดุงููุ ูููู ุงูุฑุฌูุน ููููุฏ ุงููุฏูู
- ุงุญุชูุธ ุจู commit hash ููุฅุตุฏุงุฑ ุงูุณุงุจู

## ๐ฏ ุฎุทุฉ ูุง ุจุนุฏ ุงููุดุฑ

### ุงููุฑุญูุฉ ุงูุชุงููุฉ (ุฃุณุจูุน):
- [ ] ูุฑุงุฌุนุฉ ุจุงูู views ูุชุญุฏูุซูุง ูููุธุงู ุงูุฌุฏูุฏ
- [ ] ุฅุฒุงูุฉ `accounts/permissions.py` ุงููุฏูู
- [ ] ุฅุถุงูุฉ ุงุฎุชุจุงุฑุงุช ููุตูุงุญูุงุช ุงูุฌุฏูุฏุฉ

### ุงููุฑุญูุฉ ุงููุชูุณุทุฉ (ุดูุฑ):
- [ ] ุชูุซูู ุดุงูู ูููุธุงู ุงูุฌุฏูุฏ
- [ ] ุชุฏุฑูุจ ุงููุฑูู ุนูู ุงููุธุงู ุงูุฌุฏูุฏ
- [ ] ูุฑุงุฌุนุฉ ุฃูููุฉ ุดุงููุฉ

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก**: 2025-09-27  
**ุงููุทูุฑ**: Mohamed Sakr  
**ุงูุญุงูุฉ**: ุฌุงูุฒ ูููุดุฑ ๐
