# ุฏููู ููุงุชูุฑ ูุฑุชุฌุน ุงูุดุฑุงุก
# Purchase Return Invoices Guide

## ๐ ููุฒุฉ ุฌุฏูุฏุฉ: ุงุณุชุฎุฏุงู ุฑูู ูุงุชูุฑุฉ ุงูููุฑุฏ!

ุงูุขู ููููู ุฅุถุงูุฉ ุนูุงุตุฑ ูุฑุชุฌุน ูุจุงุดุฑุฉ **ุจุงุณุชุฎุฏุงู ุฑูู ูุงุชูุฑุฉ ุงูููุฑุฏ** ุจุฏูุงู ูู ูุนุฑู ูุงุชูุฑุฉ ุงููุฑุชุฌุน:

```http
POST /invoices/purchase-return-invoice-items/create/
{
  "invoice": "4601",  // โฌ๏ธ ุฑูู ูุงุชูุฑุฉ ุงูููุฑุฏ!
  "purchase_invoice_item": 4,
  "quantity": 2
}
```

**ูุง ูุญุฏุซ ุชููุงุฆูุงู**:
- โ ูุจุญุซ ุนู ูุงุชูุฑุฉ ุงูุดุฑุงุก ุจุฑูู ุงูููุฑุฏ "4601"
- โ ููุดุฆ ูุงุชูุฑุฉ ูุฑุชุฌุน ุฌุฏูุฏุฉ (ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ)
- โ ูุถูู ุงูุนูุตุฑ ูููุงุชูุฑุฉ

---

## โ ุงูุทุฑู ุงูุตุญูุญุฉ

### โญ ุงูุทุฑููุฉ ุงูุฌุฏูุฏุฉ: ุงุณุชุฎุฏุงู ุฑูู ูุงุชูุฑุฉ ุงูููุฑุฏ (ุงูุฃุณูู!)

```http
POST http://129.212.140.152/invoices/purchase-return-invoice-items/create/
{
  "invoice": "4601",  // โฌ๏ธ ุฑูู ูุงุชูุฑุฉ ุงูููุฑุฏ
  "purchase_invoice_item": 4,
  "quantity": 2
}
```

**ุงููููุฒุงุช**:
- โ ูุง ุชุญุชุงุฌ ูุนุฑูุฉ ุฑูู ูุงุชูุฑุฉ ุงููุฑุชุฌุน
- โ ูููุดุฆ ุงููุงุชูุฑุฉ ุชููุงุฆูุงู ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ
- โ ุฃุณูู ูุฃุณุฑุน ููุงุณุชุฎุฏุงู

**ููููู ุฃูุถุงู ุงุณุชุฎุฏุงู ูุนุฑู ุงููุงุชูุฑุฉ**:
```http
{
  "invoice": "5",  // โฌ๏ธ ุฃู ูุนุฑู ูุงุชูุฑุฉ ุงููุฑุชุฌุน
  "purchase_invoice_item": 4,
  "quantity": 2
}
```

---

### ุงูุทุฑููุฉ 1: ุฅูุดุงุก ูุงุชูุฑุฉ ูุฑุชุฌุน ูุงููุฉ

```http
POST http://129.212.140.152/invoices/purchase-return-invoices/create/
Content-Type: application/json

{
  "user": 1,
  "items": [
    {
      "purchase_invoice_item": 4,
      "quantity": 2
    },
    {
      "purchase_invoice_item": 5,
      "quantity": 3
    }
  ]
}
```

**ูุฐุง ุณูููุดุฆ ุชููุงุฆูุงู**:
- โ ูุงุชูุฑุฉ ูุฑุชุฌุน ุดุฑุงุก ุฌุฏูุฏุฉ
- โ ุฌููุน ุงูุนูุงุตุฑ ุงููุทููุจุฉ
- โ ุญุณุงุจ ุงูุฅุฌูุงููุงุช ุชููุงุฆูุงู

**ุงูุงุณุชุฌุงุจุฉ**:
```json
{
  "id": 1,
  "user": {
    "id": 1,
    "name": "ุตูุฏููุฉ ุงูููุฑ"
  },
  "items_count": 2,
  "total_quantity": 5,
  "total_price": "850.00",
  "status": "placed",
  "items": [
    {
      "id": 1,
      "purchase_invoice_item": {
        "id": 4,
        "product": {
          "name": "Paracetamol 500mg"
        },
        "remaining_quantity": 98
      },
      "quantity": 2,
      "sub_total": "180.00"
    },
    {
      "id": 2,
      "purchase_invoice_item": {
        "id": 5,
        "product": {
          "name": "Ibuprofen 400mg"
        },
        "remaining_quantity": 47
      },
      "quantity": 3,
      "sub_total": "510.00"
    }
  ]
}
```

---

### ุงูุทุฑููุฉ 2: ุงูุชุญูู ูู ุงูููุงุชูุฑ ุงูููุฌูุฏุฉ

ุฅุฐุง ููุช ุชุฑูุฏ ุฅุถุงูุฉ ุนูุตุฑ ููุงุชูุฑุฉ ูุฑุชุฌุน **ููุฌูุฏุฉ ุจุงููุนู**:

#### ุงูุฎุทูุฉ 1: ุงุนุฑุถ ูุงุฆูุฉ ููุงุชูุฑ ุงููุฑุชุฌุนุงุช

```http
GET http://129.212.140.152/invoices/purchase-return-invoices/
```

**ุณุชุญุตู ุนูู**:
```json
{
  "results": [
    {
      "id": 5,  // โฌ๏ธ ุงุณุชุฎุฏู ูุฐุง ุงูุฑูู
      "user": {...},
      "status": "placed",
      "items_count": 2
    }
  ]
}
```

#### ุงูุฎุทูุฉ 2: ุฃุถู ุนูุตุฑ ูููุงุชูุฑุฉ ุงูููุฌูุฏุฉ

```http
POST http://129.212.140.152/invoices/purchase-return-invoice-items/create/
{
  "invoice": 5,  // โฌ๏ธ ุฑูู ุงููุงุชูุฑุฉ ุงูููุฌูุฏุฉ
  "purchase_invoice_item": 4,
  "quantity": 2
}
```

---

## ๐ ูุชุทูุจุงุช ุฅูุดุงุก ูุงุชูุฑุฉ ุงููุฑุชุฌุน

### 1. ุนูุตุฑ ูุงุชูุฑุฉ ุงูุดุฑุงุก ูุฌุจ ุฃู ูููู:

โ **ูู ูุงุชูุฑุฉ ุดุฑุงุก ูุบููุฉ** (`status: closed`)
โ **ูุฏูู ูููุฉ ูุชุจููุฉ** (`remaining_quantity > 0`)

### 2. ุงููููุฉ ุงููุฑุชุฌุนุฉ:

โ **ูุง ุชุชุฌุงูุฒ ุงููููุฉ ุงููุชุจููุฉ**

---

## ๐ ููู ุชุชุญูู ูู ุงูุดุฑูุทุ

### ุชุญูู ูู ุญุงูุฉ ูุงุชูุฑุฉ ุงูุดุฑุงุก

```http
GET http://129.212.140.152/invoices/purchase-invoices/1/
```

```json
{
  "id": 1,
  "status": "closed",  // โฌ๏ธ ูุฌุจ ุฃู ุชููู closed
  "items": [
    {
      "id": 4,
      "product": {
        "name": "Paracetamol 500mg"
      },
      "quantity": 100,
      "remaining_quantity": 98,  // โฌ๏ธ ูููู ุฅุฑุฌุงุน 98 ูุญุฏ ุฃูุตู
      "status": "received"
    }
  ]
}
```

---

## โ๏ธ ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ

### ุฎุทุฃ 1: ุงููุงุชูุฑุฉ ุบูุฑ ููุฌูุฏุฉ

```json
{
  "invoice": [
    "ูุนุฑู ุงูุนูุตุฑ \"1\" ุบูุฑ ุตุงูุญ - ุงูุนูุตุฑ ุบูุฑ ููุฌูุฏ."
  ]
}
```

**ุงูุญู**: ุงุณุชุฎุฏู ุฑูู ูุงุชูุฑุฉ ูุฑุชุฌุน ููุฌูุฏุฉุ ุฃู ุฃูุดุฆ ูุงุชูุฑุฉ ุฌุฏูุฏุฉ.

---

### ุฎุทุฃ 2: ุนูุตุฑ ูุงุชูุฑุฉ ุงูุดุฑุงุก ูู ูุงุชูุฑุฉ ุบูุฑ ูุบููุฉ

```json
{
  "purchase_invoice_item": [
    "ุงูุนูุตุฑ ูุฌุจ ุฃู ูููู ูู ูุงุชูุฑุฉ ูุบููุฉ"
  ]
}
```

**ุงูุญู**: ุฃุบูู ูุงุชูุฑุฉ ุงูุดุฑุงุก ุฃููุงู:

```http
PUT http://129.212.140.152/invoices/purchase-invoices/1/change-state/
{
  "supplier_invoice_number": "4601",
  "status": "closed"
}
```

---

### ุฎุทุฃ 3: ุงููููุฉ ุงููุฑุชุฌุนุฉ ุฃูุจุฑ ูู ุงููุชุจููุฉ

```json
{
  "quantity": [
    "Quantity cannot exceed 98 for this item."
  ]
}
```

**ุงูุญู**: ููู ุงููููุฉ ุงููุฑุชุฌุนุฉ.

```json
{
  "purchase_invoice_item": 4,
  "quantity": 50  // โฌ๏ธ ุจุฏูุงู ูู 200
}
```

---

## ๐ฏ ูุซุงู ูุงูู ุฎุทูุฉ ุจุฎุทูุฉ

### ุงูุณููุงุฑูู:
ุงุดุชุฑูุช 100 ูุญุฏุฉ ูู Paracetamolุ ุจุนุช 2 ูููุงุ ุนุงูุฒ ุชุฑุฌุน 5 ููููุฑุฏ.

---

### ุงูุฎุทูุฉ 1: ุชุญูู ูู ูุงุชูุฑุฉ ุงูุดุฑุงุก

```http
GET http://129.212.140.152/invoices/purchase-invoices/1/
```

**ุงูุงุณุชุฌุงุจุฉ**:
```json
{
  "id": 1,
  "status": "closed",
  "items": [
    {
      "id": 4,
      "product": {
        "name": "Paracetamol 500mg"
      },
      "quantity": 100,
      "remaining_quantity": 98,  // ุจุนุช 2ุ ุจุงูู 98
      "purchase_price": "90.00"
    }
  ]
}
```

โ ุงููุงุชูุฑุฉ ูุบููุฉ  
โ ุงููููุฉ ุงููุชุจููุฉ 98 (ุฃูุจุฑ ูู 5)

---

### ุงูุฎุทูุฉ 2: ุฃูุดุฆ ูุงุชูุฑุฉ ุงููุฑุชุฌุน

```http
POST http://129.212.140.152/invoices/purchase-return-invoices/create/
{
  "user": 1,
  "items": [
    {
      "purchase_invoice_item": 4,
      "quantity": 5
    }
  ]
}
```

**ุงูุงุณุชุฌุงุจุฉ**:
```json
{
  "id": 1,
  "user": {...},
  "items_count": 1,
  "total_quantity": 5,
  "total_price": "450.00",  // 5 ร 90 = 450
  "status": "placed",
  "items": [
    {
      "id": 1,
      "purchase_invoice_item": {
        "id": 4,
        "remaining_quantity": 93  // 98 - 5 = 93
      },
      "quantity": 5,
      "sub_total": "450.00"
    }
  ]
}
```

โ ุชู ุฅูุดุงุก ุงููุงุชูุฑุฉ  
โ ุชู ุฎุตู ุงููููุฉ ูู remaining_quantity

---

### ุงูุฎุทูุฉ 3: ุฃุบูู ูุงุชูุฑุฉ ุงููุฑุชุฌุน

```http
PUT http://129.212.140.152/invoices/purchase-return-invoices/1/change-state/
{
  "status": "closed"
}
```

**ุงูุงุณุชุฌุงุจุฉ**:
```json
{
  "status": "closed",
  "status_label": "Closed"
}
```

โ ุชู ุฅุบูุงู ุงููุงุชูุฑุฉ  
โ ุชู ุชุณุฌูู ุงููุนุงููุฉ ุงููุงููุฉ

---

## ๐ APIs ุงููุชุงุญุฉ

### ููุงุชูุฑ ุงููุฑุชุฌุนุงุช

| ุงูุทุฑููุฉ | ุงููุณุงุฑ | ุงููุตู |
|---------|--------|-------|
| GET | `/invoices/purchase-return-invoices/` | ูุงุฆูุฉ ุงูููุงุชูุฑ |
| POST | `/invoices/purchase-return-invoices/create/` | ุฅูุดุงุก ูุงุชูุฑุฉ |
| GET | `/invoices/purchase-return-invoices/{id}/` | ุชูุงุตูู ูุงุชูุฑุฉ |
| PUT | `/invoices/purchase-return-invoices/{id}/change-state/` | ุฅุบูุงู ุงููุงุชูุฑุฉ |

### ุนูุงุตุฑ ููุงุชูุฑ ุงููุฑุชุฌุนุงุช

| ุงูุทุฑููุฉ | ุงููุณุงุฑ | ุงููุตู |
|---------|--------|-------|
| GET | `/invoices/purchase-return-invoice-items/` | ูุงุฆูุฉ ุงูุนูุงุตุฑ |
| POST | `/invoices/purchase-return-invoice-items/create/` | ุฅุถุงูุฉ ุนูุตุฑ |
| GET | `/invoices/purchase-return-invoice-items/{id}/` | ุชูุงุตูู ุนูุตุฑ |

---

## ๐ก ูุตุงุฆุญ

1. โ **ุงุณุชุฎุฏู ุทุฑููุฉ ุฅูุดุงุก ุงููุงุชูุฑุฉ ุงููุงููุฉ** (ุงูุทุฑููุฉ 1) - ุฃุณูู ูุฃุณุฑุน
2. โ **ุชุฃูุฏ ูู ุฃู ูุงุชูุฑุฉ ุงูุดุฑุงุก ูุบููุฉ** ูุจู ุฅูุดุงุก ุงููุฑุชุฌุน
3. โ **ุชุญูู ูู ุงููููุฉ ุงููุชุจููุฉ** ูุจู ุฅุฑุฌุงุน ุงูุนูุงุตุฑ
4. โ **ูุง ุชูุณู ุฅุบูุงู ูุงุชูุฑุฉ ุงููุฑุชุฌุน** ุจุนุฏ ุงูุงูุชูุงุก

---

**ุขุฎุฑ ุชุญุฏูุซ**: 2025-10-10  
**ุงูุฅุตุฏุงุฑ**: 1.1.0

